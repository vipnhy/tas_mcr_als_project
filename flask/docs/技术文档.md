# TAS MCR-ALS åˆ†æå¹³å° - æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ ç›®å½•
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [æ•°æ®æ ¼å¼è§„èŒƒ](#æ•°æ®æ ¼å¼è§„èŒƒ)
- [ç®—æ³•åŸç†](#ç®—æ³•åŸç†)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·æµè§ˆå™¨                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ HTML/CSS/JS â”‚  â”‚  Bootstrap  â”‚  â”‚ Font Awesomeâ”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTP/AJAX
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Flask WebæœåŠ¡å™¨                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   è·¯ç”±å¤„ç†   â”‚  â”‚   ä¼šè¯ç®¡ç†   â”‚  â”‚   æ–‡ä»¶å¤„ç†   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   MCR-ALSç®—æ³•å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  æ•°æ®é¢„å¤„ç†  â”‚  â”‚  ç®—æ³•è®¡ç®—    â”‚  â”‚  ç»“æœç”Ÿæˆ    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   æ•°æ®å­˜å‚¨å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  ä¸Šä¼ æ–‡ä»¶    â”‚  â”‚  ä¸´æ—¶æ•°æ®    â”‚  â”‚  ç»“æœæ–‡ä»¶    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
flask/
â”œâ”€â”€ app.py                    # Flaskä¸»åº”ç”¨
â”œâ”€â”€ run_server.py            # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ core_analyzer.py         # MCR-ALSæ ¸å¿ƒåˆ†ææ¨¡å—
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–åŒ…
â”œâ”€â”€ static/                  # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css       # è‡ªå®šä¹‰æ ·å¼
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ app.js          # å‰ç«¯äº¤äº’é€»è¾‘
â”‚   â””â”€â”€ images/             # å›¾ç‰‡èµ„æº
â”œâ”€â”€ templates/              # Jinja2æ¨¡æ¿
â”‚   â”œâ”€â”€ base.html          # åŸºç¡€æ¨¡æ¿
â”‚   â”œâ”€â”€ index.html         # ä¸»é¡µ
â”‚   â”œâ”€â”€ upload.html        # ä¸Šä¼ é¡µé¢
â”‚   â”œâ”€â”€ analyze.html       # åˆ†æé¡µé¢
â”‚   â”œâ”€â”€ results.html       # ç»“æœé¡µé¢
â”‚   â”œâ”€â”€ sessions.html      # å†å²ä¼šè¯
â”‚   â””â”€â”€ 404.html           # é”™è¯¯é¡µé¢
â”œâ”€â”€ uploads/               # ä¸Šä¼ æ–‡ä»¶å­˜å‚¨
â”œâ”€â”€ results/              # åˆ†æç»“æœå­˜å‚¨
â””â”€â”€ docs/                 # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ ä½¿ç”¨æŒ‡å—.md
    â””â”€â”€ æŠ€æœ¯æ–‡æ¡£.md
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.8æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: æœ€å°2GBï¼Œæ¨è4GB
- **å­˜å‚¨**: æœ€å°500MBå¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: HTTPç«¯å£5000è®¿é—®æƒé™

### å¿«é€Ÿéƒ¨ç½²

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-repo/tas_mcr_als_project.git
cd tas_mcr_als_project/flask
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/macOS
python3 -m venv venv
source venv/bin/activate
```

#### 3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

#### 4. å¯åŠ¨æœåŠ¡
```bash
python run_server.py
```

#### 5. è®¿é—®åº”ç”¨
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5000`

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### ä½¿ç”¨Gunicorn (Linux)
```bash
# å®‰è£…Gunicorn
pip install gunicorn

# å¯åŠ¨æœåŠ¡
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

#### ä½¿ç”¨Nginxåå‘ä»£ç†
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /static {
        alias /path/to/flask/static;
        expires 30d;
    }
}
```

#### Dockeréƒ¨ç½²
```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 5000

CMD ["python", "run_server.py"]
```

---

## ğŸ“¡ APIæ–‡æ¡£

### è·¯ç”±ç«¯ç‚¹

#### 1. ä¸»é¡µ
```
GET /
æè¿°: è¿”å›ä¸»é¡µHTML
å“åº”: index.htmlæ¨¡æ¿
```

#### 2. æ–‡ä»¶ä¸Šä¼ é¡µé¢
```
GET /upload
æè¿°: è¿”å›ä¸Šä¼ é¡µé¢HTML
å“åº”: upload.htmlæ¨¡æ¿
```

#### 3. æ–‡ä»¶ä¸Šä¼ å¤„ç†
```
POST /upload
æè¿°: å¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œåˆ†æå‚æ•°
å‚æ•°:
  - file: ä¸Šä¼ çš„æ•°æ®æ–‡ä»¶
  - components: ç»„åˆ†æ•°é‡ (int)
  - max_iterations: æœ€å¤§è¿­ä»£æ¬¡æ•° (int)
  - wavelength_min: æœ€å°æ³¢é•¿ (float)
  - wavelength_max: æœ€å¤§æ³¢é•¿ (float)
  - delay_min: æœ€å°å»¶è¿Ÿ (float)
  - delay_max: æœ€å¤§å»¶è¿Ÿ (float)
  - language: ç•Œé¢è¯­è¨€ (str)
å“åº”: é‡å®šå‘åˆ°åˆ†æé¡µé¢
```

#### 4. åˆ†æé¡µé¢
```
GET /analyze/<session_id>
æè¿°: è¿”å›åˆ†æè¿›åº¦é¡µé¢
å‚æ•°: session_id - ä¼šè¯ID
å“åº”: analyze.htmlæ¨¡æ¿
```

#### 5. å¼€å§‹åˆ†æ
```
POST /start_analysis/<session_id>
æè¿°: å¯åŠ¨MCR-ALSåˆ†æ
å‚æ•°: session_id - ä¼šè¯ID
å“åº”: JSONçŠ¶æ€ä¿¡æ¯
```

#### 6. åˆ†æçŠ¶æ€
```
GET /analysis_status/<session_id>
æè¿°: è·å–å®æ—¶åˆ†æçŠ¶æ€
å‚æ•°: session_id - ä¼šè¯ID
å“åº”: JSONæ ¼å¼çš„çŠ¶æ€å’Œæ—¥å¿—
```

#### 7. ç»“æœé¡µé¢
```
GET /results/<session_id>
æè¿°: è¿”å›åˆ†æç»“æœé¡µé¢
å‚æ•°: session_id - ä¼šè¯ID
å“åº”: results.htmlæ¨¡æ¿
```

#### 8. å›¾è¡¨é¢„è§ˆ
```
GET /preview_chart/<session_id>/<chart_type>
æè¿°: é¢„è§ˆåˆ†æå›¾è¡¨
å‚æ•°:
  - session_id: ä¼šè¯ID
  - chart_type: å›¾è¡¨ç±»å‹ (concentration/spectra/lof)
å“åº”: PNGå›¾ç‰‡
```

#### 9. æ–‡ä»¶ä¸‹è½½
```
GET /download/<session_id>/<filename>
æè¿°: ä¸‹è½½ç»“æœæ–‡ä»¶
å‚æ•°:
  - session_id: ä¼šè¯ID
  - filename: æ–‡ä»¶å
å“åº”: æ–‡ä»¶ä¸‹è½½
```

#### 10. æ‰¹é‡ä¸‹è½½
```
GET /download_all/<session_id>
æè¿°: ä¸‹è½½æ‰€æœ‰ç»“æœæ–‡ä»¶
å‚æ•°: session_id - ä¼šè¯ID
å“åº”: ZIPå‹ç¼©åŒ…ä¸‹è½½
```

### å“åº”æ ¼å¼

#### æˆåŠŸå“åº”
```json
{
    "status": "success",
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        // å…·ä½“æ•°æ®
    }
}
```

#### é”™è¯¯å“åº”
```json
{
    "status": "error",
    "message": "é”™è¯¯æè¿°",
    "error_code": "ERROR_CODE"
}
```

#### åˆ†æçŠ¶æ€å“åº”
```json
{
    "status": "running|completed|error",
    "progress": 75,
    "current_step": "MCRè®¡ç®—ä¸­",
    "iteration": 45,
    "max_iteration": 100,
    "lof": 92.5,
    "logs": [
        {"level": "info", "message": "å¼€å§‹åˆ†æ...", "timestamp": "..."},
        {"level": "success", "message": "æ”¶æ•›æˆåŠŸ", "timestamp": "..."}
    ]
}
```

---

## ğŸ“Š æ•°æ®æ ¼å¼è§„èŒƒ

### è¾“å…¥æ•°æ®æ ¼å¼

#### CSVæ ¼å¼ç¤ºä¾‹
```csv
Wavelength(nm),0.1ps,0.2ps,0.5ps,1ps,2ps,5ps,10ps,20ps,50ps,100ps
350,0.001,0.002,0.003,0.004,0.005,0.004,0.003,0.002,0.001,0.000
351,0.002,0.003,0.004,0.005,0.006,0.005,0.004,0.003,0.002,0.001
352,0.003,0.004,0.005,0.006,0.007,0.006,0.005,0.004,0.003,0.002
...
700,0.000,0.001,0.002,0.001,0.000,-0.001,-0.002,-0.001,0.000,0.001
```

#### æ•°æ®è¦æ±‚
- **ç¬¬ä¸€è¡Œ**: æ ‡é¢˜è¡Œï¼ŒåŒ…å«æ³¢é•¿æ ‡ç­¾å’Œæ—¶é—´å»¶è¿Ÿå€¼
- **ç¬¬ä¸€åˆ—**: æ³¢é•¿å€¼ï¼Œå•ä½ä¸ºçº³ç±³(nm)
- **æ•°æ®åˆ—**: å¯¹åº”æ—¶é—´å»¶è¿Ÿçš„å¸å…‰åº¦å€¼
- **æ•°å€¼æ ¼å¼**: æµ®ç‚¹æ•°ï¼Œæ”¯æŒç§‘å­¦è®¡æ•°æ³•
- **åˆ†éš”ç¬¦**: é€—å·æˆ–åˆ¶è¡¨ç¬¦
- **ç¼–ç **: UTF-8

### è¾“å‡ºæ•°æ®æ ¼å¼

#### 1. æµ“åº¦è½®å»“æ•°æ® (concentration_data.csv)
```csv
Time(ps),Component_1,Component_2,Component_3
0.1,0.847,0.123,0.030
0.2,0.821,0.151,0.028
0.5,0.754,0.208,0.038
1.0,0.651,0.284,0.065
2.0,0.523,0.371,0.106
5.0,0.342,0.457,0.201
10.0,0.198,0.502,0.300
20.0,0.087,0.485,0.428
50.0,0.021,0.379,0.600
100.0,0.003,0.257,0.740
```

#### 2. çº¯å…‰è°±æ•°æ® (spectra_data.csv)
```csv
Wavelength(nm),Component_1,Component_2,Component_3
350,0.012,-0.003,0.001
351,0.015,-0.004,0.002
352,0.018,-0.005,0.003
...
700,-0.002,0.001,-0.001
```

#### 3. æ”¶æ•›å†å² (lof_history.csv)
```csv
Iteration,LOF_Percent,Convergence_Criteria
1,98.52,0.0
2,96.18,2.34
3,94.83,1.35
4,93.71,1.12
...
78,90.13,0.08
```

#### 4. åˆ†æå‚æ•° (analysis_parameters.json)
```json
{
    "input_file": "example_data.csv",
    "components": 3,
    "max_iterations": 100,
    "convergence_criteria": 0.1,
    "wavelength_range": [350, 700],
    "delay_range": [0.1, 100],
    "language": "ä¸­æ–‡",
    "analysis_time": "2025-08-28 14:30:25",
    "final_lof": 90.13,
    "iterations_used": 78,
    "convergence_achieved": true
}
```

---

## ğŸ”¬ ç®—æ³•åŸç†

### MCR-ALSç®—æ³•æ¦‚è¿°

å¤šå…ƒæ›²çº¿åˆ†è¾¨-äº¤æ›¿æœ€å°äºŒä¹˜æ³•(MCR-ALS)æ˜¯ä¸€ç§ç”¨äºåˆ†ç¦»é‡å ä¿¡å·çš„åŒ–å­¦è®¡é‡å­¦æ–¹æ³•ï¼Œç‰¹åˆ«é€‚ç”¨äºç¬æ€å¸æ”¶å…‰è°±æ•°æ®åˆ†æã€‚

#### æ•°å­¦æ¨¡å‹

åŸå§‹æ•°æ®çŸ©é˜µå¯ä»¥è¡¨ç¤ºä¸ºï¼š
```
D = C Ã— S^T + E
```

å…¶ä¸­ï¼š
- `D`: å®éªŒæ•°æ®çŸ©é˜µ (mÃ—n)
- `C`: æµ“åº¦è½®å»“çŸ©é˜µ (mÃ—r)
- `S^T`: çº¯å…‰è°±çŸ©é˜µçš„è½¬ç½® (rÃ—n)
- `E`: æ®‹å·®çŸ©é˜µ (mÃ—n)
- `m`: æ—¶é—´ç‚¹æ•°
- `n`: æ³¢é•¿ç‚¹æ•°
- `r`: åŒ–å­¦ç»„åˆ†æ•°

#### ç®—æ³•æµç¨‹

```
1. åˆå§‹åŒ–:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ a) ä½¿ç”¨SIMPLISMAç®—æ³•ä¼°è®¡åˆå§‹çº¯å…‰è°±     â”‚
   â”‚ b) è®¡ç®—å¯¹åº”çš„åˆå§‹æµ“åº¦è½®å»“               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
2. äº¤æ›¿æœ€å°äºŒä¹˜è¿­ä»£:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ while (not converged):                  â”‚
   â”‚   a) å›ºå®šSï¼Œæ±‚è§£C: C = D Ã— S Ã— (S^TÃ—S)^-1â”‚
   â”‚   b) åº”ç”¨æµ“åº¦çº¦æŸ (éè´Ÿæ€§ç­‰)            â”‚
   â”‚   c) å›ºå®šCï¼Œæ±‚è§£S^T: S^T = (C^TÃ—C)^-1Ã—C^TÃ—Dâ”‚
   â”‚   d) åº”ç”¨å…‰è°±çº¦æŸ (å½’ä¸€åŒ–ç­‰)            â”‚
   â”‚   e) è®¡ç®—LOFï¼Œæ£€æŸ¥æ”¶æ•›æ€§                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
3. ç»“æœè¾“å‡º:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ a) æœ€ç»ˆæµ“åº¦è½®å»“çŸ©é˜µC                    â”‚
   â”‚ b) æœ€ç»ˆçº¯å…‰è°±çŸ©é˜µS                      â”‚
   â”‚ c) æ‹Ÿåˆè´¨é‡æŒ‡æ ‡LOF                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ”¶æ•›åˆ¤æ®

ç¼ºå¤±æ‹Ÿåˆåº¦(Lack of Fit, LOF)å®šä¹‰ä¸ºï¼š
```
LOF = 100 Ã— âˆš(Î£(D_ij - D_fit_ij)Â²) / âˆš(Î£(D_ij)Â²)
```

å½“è¿ç»­è¿­ä»£çš„LOFå˜åŒ–å°äºè®¾å®šé˜ˆå€¼(é€šå¸¸0.1%)æ—¶ï¼Œè®¤ä¸ºç®—æ³•æ”¶æ•›ã€‚

#### çº¦æŸæ¡ä»¶

1. **éè´Ÿæ€§çº¦æŸ**: æµ“åº¦å’Œå…‰è°±å€¼ä¸èƒ½ä¸ºè´Ÿ
2. **å½’ä¸€åŒ–çº¦æŸ**: æµ“åº¦è½®å»“å½’ä¸€åŒ–ä¸º0-1èŒƒå›´
3. **è´¨é‡å¹³è¡¡**: ç¡®ä¿æ€»æµ“åº¦å®ˆæ’

### SIMPLISMAåˆå§‹åŒ–

ç®€å•äº¤æ›¿æœ€å°è‡ªå»ºæ¨¡(SIMPLISMA)ç®—æ³•ç”¨äºä¼°è®¡åˆå§‹çº¯å…‰è°±ï¼š

```python
def simplisma_initialization(data, n_components):
    """
    SIMPLISMAç®—æ³•å®ç°
    """
    purity = calculate_purity(data)
    pure_indices = []
    
    for i in range(n_components):
        max_purity_idx = find_max_purity(purity)
        pure_indices.append(max_purity_idx)
        update_purity(purity, data[:, max_purity_idx])
    
    return data[:, pure_indices]
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–

#### 1. èµ„æºå‹ç¼©
- CSS/JSæ–‡ä»¶å‹ç¼©
- å›¾ç‰‡æ ¼å¼ä¼˜åŒ–
- å­—ä½“æ–‡ä»¶å‹ç¼©

#### 2. ç¼“å­˜ç­–ç•¥
```javascript
// è®¾ç½®é™æ€èµ„æºç¼“å­˜
app.config['SEND_FILE_MAX_AGE_DEFAULT'] = 31536000  // 1å¹´

// ç‰ˆæœ¬æ§åˆ¶
<link rel="stylesheet" href="style.css?v=1.0.0">
```

#### 3. å¼‚æ­¥åŠ è½½
```javascript
// ä½¿ç”¨Promiseè¿›è¡Œå¼‚æ­¥æ“ä½œ
async function checkAnalysisStatus(sessionId) {
    try {
        const response = await fetch(`/analysis_status/${sessionId}`);
        const data = await response.json();
        updateProgressDisplay(data);
    } catch (error) {
        console.error('Status check failed:', error);
    }
}
```

### åç«¯ä¼˜åŒ–

#### 1. æ•°æ®ç»“æ„ä¼˜åŒ–
```python
# ä½¿ç”¨NumPyå‘é‡åŒ–æ“ä½œ
import numpy as np

# é¿å…å¾ªç¯ï¼Œä½¿ç”¨çŸ©é˜µè¿ç®—
def matrix_multiplication_optimized(A, B):
    return np.dot(A, B)  # æ¯”åµŒå¥—å¾ªç¯å¿«10-100å€
```

#### 2. å†…å­˜ç®¡ç†
```python
# åŠæ—¶é‡Šæ”¾å¤§å‹æ•°ç»„
del large_array
gc.collect()

# ä½¿ç”¨å†…å­˜æ˜ å°„å¤„ç†å¤§æ–‡ä»¶
data = np.memmap('large_file.dat', dtype='float32', mode='r')
```

#### 3. å¹¶è¡Œè®¡ç®—
```python
from concurrent.futures import ThreadPoolExecutor

def parallel_analysis(data_chunks):
    with ThreadPoolExecutor(max_workers=4) as executor:
        results = list(executor.map(analyze_chunk, data_chunks))
    return combine_results(results)
```

### ç®—æ³•ä¼˜åŒ–

#### 1. æ”¶æ•›åŠ é€Ÿ
```python
def adaptive_convergence_check(lof_history, tolerance=0.1):
    """
    è‡ªé€‚åº”æ”¶æ•›æ£€æµ‹
    """
    if len(lof_history) < 5:
        return False
    
    recent_change = np.mean(np.diff(lof_history[-5:]))
    return abs(recent_change) < tolerance
```

#### 2. ç¨€ç–çŸ©é˜µä¼˜åŒ–
```python
from scipy.sparse import csr_matrix

# å¯¹äºç¨€ç–æ•°æ®ä½¿ç”¨ç¨€ç–çŸ©é˜µ
if sparsity_ratio(data) > 0.8:
    sparse_data = csr_matrix(data)
    # ä½¿ç”¨ç¨€ç–çŸ©é˜µç®—æ³•
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### 1. æ¨¡å—å¯¼å…¥é”™è¯¯
```
é”™è¯¯: ModuleNotFoundError: No module named 'flask'
è§£å†³: ç¡®ä¿å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…äº†requirements.txtä¸­çš„æ‰€æœ‰ä¾èµ–
å‘½ä»¤: pip install -r requirements.txt
```

#### 2. ç«¯å£å ç”¨é”™è¯¯
```
é”™è¯¯: OSError: [Errno 48] Address already in use
è§£å†³: æ›´æ”¹ç«¯å£æˆ–æ€æ­»å ç”¨è¿›ç¨‹
å‘½ä»¤: 
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :5000
# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

#### 3. æ–‡ä»¶æƒé™é”™è¯¯
```
é”™è¯¯: PermissionError: [Errno 13] Permission denied
è§£å†³: æ£€æŸ¥æ–‡ä»¶å’Œç›®å½•æƒé™
å‘½ä»¤: chmod 755 uploads/ results/
```

#### 4. å†…å­˜ä¸è¶³é”™è¯¯
```
é”™è¯¯: MemoryError: Unable to allocate array
è§£å†³: 
1. å‡å°‘æ•°æ®å¤§å°
2. å¢åŠ ç³»ç»Ÿå†…å­˜
3. ä½¿ç”¨æ•°æ®åˆ†å—å¤„ç†
```

#### 5. æ”¶æ•›å¤±è´¥
```
é—®é¢˜: ç®—æ³•ä¸æ”¶æ•›æˆ–æ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜
è§£å†³:
1. è°ƒæ•´åˆå§‹å€¼è®¾ç½®
2. ä¿®æ”¹æ”¶æ•›åˆ¤æ®
3. å¢åŠ æœ€å¤§è¿­ä»£æ¬¡æ•°
4. æ£€æŸ¥æ•°æ®è´¨é‡
```

### è°ƒè¯•å·¥å…·

#### 1. æ—¥å¿—ç³»ç»Ÿ
```python
import logging

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('app.log'),
        logging.StreamHandler()
    ]
)

# ä½¿ç”¨æ—¥å¿—
logger = logging.getLogger(__name__)
logger.info("åˆ†æå¼€å§‹")
logger.error("è®¡ç®—é”™è¯¯: %s", error_message)
```

#### 2. æ€§èƒ½åˆ†æ
```python
import cProfile
import pstats

# åˆ†æå‡½æ•°æ€§èƒ½
def profile_function(func, *args, **kwargs):
    profiler = cProfile.Profile()
    profiler.enable()
    result = func(*args, **kwargs)
    profiler.disable()
    
    stats = pstats.Stats(profiler)
    stats.sort_stats('tottime')
    stats.print_stats()
    
    return result
```

#### 3. å†…å­˜ç›‘æ§
```python
import tracemalloc
import psutil

def monitor_memory():
    # è·Ÿè¸ªå†…å­˜åˆ†é…
    tracemalloc.start()
    
    # è·å–ç³»ç»Ÿå†…å­˜ä¿¡æ¯
    memory = psutil.virtual_memory()
    print(f"å¯ç”¨å†…å­˜: {memory.available / 1024**3:.2f} GB")
    
    # æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æœ€å¤šçš„ä»£ç è¡Œ
    current, peak = tracemalloc.get_traced_memory()
    print(f"å½“å‰å†…å­˜ä½¿ç”¨: {current / 1024**2:.2f} MB")
    print(f"å³°å€¼å†…å­˜ä½¿ç”¨: {peak / 1024**2:.2f} MB")
```

### å¤‡ä»½å’Œæ¢å¤

#### 1. æ•°æ®å¤‡ä»½
```bash
#!/bin/bash
# backup.sh - è‡ªåŠ¨å¤‡ä»½è„šæœ¬

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/tas_mcr_${DATE}"

mkdir -p $BACKUP_DIR
cp -r uploads/ $BACKUP_DIR/
cp -r results/ $BACKUP_DIR/
cp requirements.txt $BACKUP_DIR/
cp app.py $BACKUP_DIR/

echo "å¤‡ä»½å®Œæˆ: $BACKUP_DIR"
```

#### 2. é…ç½®ç®¡ç†
```python
# config.py - é…ç½®æ–‡ä»¶
import os

class Config:
    SECRET_KEY = os.environ.get('SECRET_KEY') or 'dev-secret-key'
    UPLOAD_FOLDER = os.environ.get('UPLOAD_FOLDER') or 'uploads'
    RESULTS_FOLDER = os.environ.get('RESULTS_FOLDER') or 'results'
    MAX_CONTENT_LENGTH = 50 * 1024 * 1024  # 50MB
    
class DevelopmentConfig(Config):
    DEBUG = True
    
class ProductionConfig(Config):
    DEBUG = False
```

---

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### ç³»ç»Ÿç›‘æ§

#### 1. å¥åº·æ£€æŸ¥ç«¯ç‚¹
```python
@app.route('/health')
def health_check():
    """ç³»ç»Ÿå¥åº·æ£€æŸ¥"""
    try:
        # æ£€æŸ¥å…³é”®ç»„ä»¶
        disk_usage = psutil.disk_usage('/')
        memory_usage = psutil.virtual_memory()
        
        status = {
            'status': 'healthy',
            'disk_free': disk_usage.free,
            'memory_available': memory_usage.available,
            'timestamp': datetime.now().isoformat()
        }
        
        return jsonify(status), 200
    except Exception as e:
        return jsonify({'status': 'unhealthy', 'error': str(e)}), 500
```

#### 2. æŒ‡æ ‡æ”¶é›†
```python
from prometheus_client import Counter, Histogram, generate_latest

# å®šä¹‰æŒ‡æ ‡
REQUEST_COUNT = Counter('http_requests_total', 'Total HTTP requests')
REQUEST_DURATION = Histogram('http_request_duration_seconds', 'HTTP request duration')

@app.route('/metrics')
def metrics():
    """PrometheusæŒ‡æ ‡ç«¯ç‚¹"""
    return generate_latest()
```

### å®šæœŸç»´æŠ¤

#### 1. æ¸…ç†è„šæœ¬
```python
# cleanup.py - å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶
import os
import time
from datetime import datetime, timedelta

def cleanup_old_files(directory, days=7):
    """åˆ é™¤æŒ‡å®šå¤©æ•°å‰çš„æ–‡ä»¶"""
    cutoff_time = time.time() - (days * 24 * 60 * 60)
    
    for root, dirs, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            if os.path.getmtime(file_path) < cutoff_time:
                os.remove(file_path)
                print(f"å·²åˆ é™¤: {file_path}")

if __name__ == "__main__":
    cleanup_old_files('uploads', days=7)
    cleanup_old_files('results', days=30)
```

#### 2. æ•°æ®åº“ç»´æŠ¤(å¦‚æœ‰)
```python
# å¦‚æœä½¿ç”¨æ•°æ®åº“ï¼Œå®šæœŸç»´æŠ¤ç¤ºä¾‹
def database_maintenance():
    """æ•°æ®åº“ç»´æŠ¤ä»»åŠ¡"""
    # æ¸…ç†è¿‡æœŸä¼šè¯
    expired_sessions = Session.query.filter(
        Session.created_at < datetime.now() - timedelta(days=30)
    ).all()
    
    for session in expired_sessions:
        db.session.delete(session)
    
    db.session.commit()
    print(f"æ¸…ç†äº† {len(expired_sessions)} ä¸ªè¿‡æœŸä¼šè¯")
```

---

*æŠ€æœ¯æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0.0*  
*æœ€åæ›´æ–°ï¼š2025å¹´8æœˆ28æ—¥*  
*ç»´æŠ¤å›¢é˜Ÿï¼šTAS-MCR-ALSå¼€å‘å›¢é˜Ÿ*
