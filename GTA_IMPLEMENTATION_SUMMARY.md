# GTAæ¨¡å—å®ç°æ€»ç»“æŠ¥å‘Š

## é¡¹ç›®æ¦‚è¿°

åŸºäºEfsTAçš„User Guideè®¾è®¡ï¼Œä¸ºTAS MCR-ALSé¡¹ç›®æˆåŠŸå®ç°äº†å®Œæ•´çš„Global Target Analysis (GTA)åˆ†æåŠŸèƒ½ã€‚è¯¥æ¨¡å—æä¾›äº†ä»åŠ¨åŠ›å­¦å»ºæ¨¡åˆ°å‚æ•°æ‹Ÿåˆã€ä»ç»“æœå¯è§†åŒ–åˆ°ç³»ç»Ÿé›†æˆçš„å…¨å¥—è§£å†³æ–¹æ¡ˆã€‚

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. åŠ¨åŠ›å­¦æ¨¡å‹æ¨¡å— (kinetic_models.py)
- âœ… **8ä¸ªé¢„å®šä¹‰æ¨¡å‹**: å®Œå…¨æŒ‰ç…§EfsTAæ ‡å‡†å®ç°
  - Model 1-2: é€šç”¨é¡ºåºæ¨¡å‹
  - Model 3-6: ç‰¹å®šç‰©ç§æ•°çš„åˆ†æ”¯æ¨¡å‹  
  - Model 7-8: å¹³è¡Œåˆ†æ”¯æ¨¡å‹
- âœ… **è‡ªåŠ¨çŸ©é˜µç”Ÿæˆ**: æ ¹æ®é€Ÿç‡å¸¸æ•°è‡ªåŠ¨æ„å»ºåŠ¨åŠ›å­¦çŸ©é˜µ
- âœ… **æ¨¡å‹éªŒè¯**: å‚æ•°å…¼å®¹æ€§æ£€æŸ¥
- âœ… **ä¿¡æ¯æŸ¥è¯¢**: æ¨¡å‹æè¿°ã€ç‰©ç§æ•°ã€ååº”ç±»å‹ç­‰

**æµ‹è¯•ç»“æœ**: âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ï¼Œå¯ç”Ÿæˆæ­£ç¡®çš„åŠ¨åŠ›å­¦çŸ©é˜µ

### 2. ååº”æ–¹ç¨‹è§£æå™¨ (reaction_parser.py)
- âœ… **å¤šç§è¯­æ³•æ”¯æŒ**: ç®­å¤´è®°å· (`A->B->C`)ã€ç´§å‡‘è®°å· (`ABC`)
- âœ… **åˆ†æ”¯ååº”**: åˆ†å·åˆ†éš”çš„å¤æ‚ååº”ç½‘ç»œ
- âœ… **åŸºæ€è¡°å‡**: `v`è¡¨ç¤ºè¡°å‡åˆ°åŸºæ€
- âœ… **è¯­æ³•éªŒè¯**: å®Œæ•´çš„é”™è¯¯æ£€æŸ¥å’Œæç¤º
- âœ… **è‡ªåŠ¨çŸ©é˜µæ„å»º**: ä»ååº”æ–¹ç¨‹ç›´æ¥ç”ŸæˆåŠ¨åŠ›å­¦çŸ©é˜µ

**æµ‹è¯•ç»“æœ**: âœ… è§£æåŠŸèƒ½æ­£å¸¸ï¼Œæ”¯æŒå„ç§ååº”ç±»å‹

### 3. GTAæ±‚è§£å™¨ (gta_solver.py)
- âœ… **ODEæ±‚è§£**: ä½¿ç”¨scipy.integrateæ±‚è§£æµ“åº¦æ¼”åŒ–
- âœ… **å‚æ•°ä¼˜åŒ–**: é›†æˆlmfitè¿›è¡Œéçº¿æ€§æ‹Ÿåˆ
- âœ… **SASè®¡ç®—**: ç‰©ç§å…³è”å…‰è°±è‡ªåŠ¨è®¡ç®—
- âœ… **æ®‹å·®åˆ†æ**: å®Œæ•´çš„æ‹Ÿåˆè´¨é‡è¯„ä¼°
- âœ… **è¾¹ç•Œçº¦æŸ**: æ”¯æŒå‚æ•°è¾¹ç•Œå’Œå›ºå®šå‚æ•°
- âœ… **ç½®ä¿¡åŒºé—´**: å‚æ•°ä¸ç¡®å®šåº¦è®¡ç®—

**æ ¸å¿ƒç®—æ³•éªŒè¯**: âœ… åŸºç¡€åŠŸèƒ½å·²éªŒè¯ï¼Œç­‰å¾…çœŸå®æ•°æ®æµ‹è¯•

### 4. å¯è§†åŒ–æ¨¡å— (visualization.py)
- âœ… **SASå…‰è°±å›¾**: ç‰©ç§å…³è”å…‰è°±å¯è§†åŒ–
- âœ… **æµ“åº¦æ¼”åŒ–å›¾**: æ—¶é—´ä¾èµ–çš„æµ“åº¦å˜åŒ–
- âœ… **æ®‹å·®åˆ†æ**: 2Dæ®‹å·®çƒ­å›¾
- âœ… **æ‹Ÿåˆè´¨é‡**: ç»¼åˆæ‹Ÿåˆè¯„ä¼°å›¾è¡¨
- âœ… **åŒè¯­æ”¯æŒ**: ä¸­æ–‡/è‹±æ–‡æ ‡ç­¾åˆ‡æ¢
- âœ… **æ‰¹é‡å¯¼å‡º**: å®Œæ•´åˆ†ææŠ¥å‘Šç”Ÿæˆ

**è®¾è®¡ç‰¹è‰²**: éµå¾ªé¡¹ç›®å¯è§†åŒ–æ ‡å‡†ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼

### 5. é…ç½®é›†æˆæ¨¡å— (integration.py)
- âœ… **é…ç½®æ¨¡æ¿**: 8ç§é¢„å®šä¹‰æ¨¡å‹çš„é…ç½®æ¨¡æ¿
- âœ… **æ ¼å¼è½¬æ¢**: ä¸existing globalfitç³»ç»Ÿå…¼å®¹
- âœ… **å‘½åè§„èŒƒ**: ç¬¦åˆé¡¹ç›®æ–‡ä»¶å‘½åçº¦å®š
- âœ… **æ‰¹é‡åˆ†æ**: å¤šæ¨¡å‹æ¯”è¾ƒåˆ†ææ”¯æŒ
- âœ… **ç»“æœå¯¼å‡º**: æ ‡å‡†åŒ–ç»“æœæ–‡ä»¶æ ¼å¼

**é›†æˆç­–ç•¥**: å®Œç¾èå…¥ç°æœ‰analysis_toolæ¶æ„

## ä¸EfsTAå¯¹æ¯”åˆ†æ

| åŠŸèƒ½ç‰¹æ€§ | EfsTA | æœ¬å®ç° | çŠ¶æ€ |
|---------|--------|--------|------|
| é¢„å®šä¹‰æ¨¡å‹æ•°é‡ | 8ä¸ª | 8ä¸ª | âœ… å®Œå…¨åŒ¹é… |
| è‡ªå®šä¹‰ååº”æ–¹ç¨‹ | æ”¯æŒ | æ”¯æŒ | âœ… åŠŸèƒ½å¢å¼º |
| å‚æ•°ä¼˜åŒ–ç®—æ³• | lmfit | lmfit | âœ… ç®—æ³•ä¸€è‡´ |
| ODEæ±‚è§£å™¨ | scipy | scipy | âœ… æ–¹æ³•ç›¸åŒ |
| å¯è§†åŒ–åŠŸèƒ½ | åŸºç¡€ | å¢å¼º | âœ… åŠŸèƒ½æ‰©å±• |
| ç³»ç»Ÿé›†æˆ | ç‹¬ç«‹ | æ·±åº¦é›†æˆ | âœ… ä¼˜åŠ¿æ˜æ˜¾ |
| åŒè¯­æ”¯æŒ | æ—  | æœ‰ | âœ… æœ¬åœŸåŒ–ä¼˜åŠ¿ |

**ç»“è®º**: åœ¨ä¿æŒEfsTAæ ¸å¿ƒåŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œå®ç°äº†æ›´å¥½çš„é›†æˆæ€§å’Œå¯æ‰©å±•æ€§ã€‚

## æŠ€æœ¯åˆ›æ–°ç‚¹

### 1. æ™ºèƒ½ååº”æ–¹ç¨‹è§£æ
- **å¤šè¯­æ³•æ”¯æŒ**: ç®­å¤´å’Œç´§å‡‘ä¸¤ç§è®°å·æ³•
- **è‡ªåŠ¨éªŒè¯**: è¯­æ³•é”™è¯¯å®æ—¶æ£€æµ‹
- **çŸ©é˜µç”Ÿæˆ**: ç›´æ¥ä»æ–‡æœ¬ç”Ÿæˆæ•°å­¦æ¨¡å‹

### 2. æ¨¡å—åŒ–æ¶æ„è®¾è®¡
- **é«˜å†…èšä½è€¦åˆ**: å„æ¨¡å—ç‹¬ç«‹å¯æµ‹è¯•
- **æ¥å£æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„è°ƒç”¨æ¥å£
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸ç®¡ç†æœºåˆ¶

### 3. é…ç½®é©±åŠ¨çš„é›†æˆæ–¹æ¡ˆ
- **æ¨¡æ¿åŒ–é…ç½®**: é¢„å®šä¹‰é…ç½®å‡å°‘é”™è¯¯
- **è‡ªåŠ¨è½¬æ¢**: ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼å¯¹æ¥
- **ç‰ˆæœ¬å…¼å®¹**: å‘åå…¼å®¹çš„è®¾è®¡

### 4. å¢å¼ºçš„å¯è§†åŒ–èƒ½åŠ›
- **å‡ºç‰ˆçº§è´¨é‡**: æ”¯æŒå¤šç§å›¾è¡¨æ ·å¼
- **äº¤äº’å¼æ¢ç´¢**: ä¸°å¯Œçš„å‚æ•°è°ƒèŠ‚
- **æ‰¹é‡æŠ¥å‘Š**: ä¸€é”®ç”Ÿæˆå®Œæ•´åˆ†ææŠ¥å‘Š

## ç³»ç»Ÿé›†æˆæ–¹æ¡ˆ

### 1. ä¸analysis_toolé›†æˆ

```python
# åœ¨global_batch.pyä¸­æ·»åŠ GTAæ¨¡å‹
def get_gta_models():
    """è·å–GTAæ¨¡å‹é…ç½®"""
    from gta_analysis import GTAConfig
    
    config_manager = GTAConfig()
    gta_models = {}
    
    for model_type, template in config_manager.model_templates.items():
        model_name = f"gta_{template['pathway_type']}"
        gta_models[model_name] = {
            'display_name': template['display_name'],
            'model_type': 'kinetic',
            'analysis_method': 'gta',
            'template': template
        }
    
    return gta_models
```

### 2. ä¸Globalfité›†æˆ

```python
# åœ¨Globalfit/interface.pyä¸­æ·»åŠ GTAæ¥å£
def run_gta_analysis(data_config, model_config):
    """è¿è¡ŒGTAåˆ†æ"""
    from gta_analysis import GTASolver, KineticModels
    
    # åŠ è½½æ•°æ®
    wavelengths, delays, spectra = load_data(data_config)
    
    # åˆ›å»ºæ¨¡å‹
    if model_config['type'] == 'predefined':
        kinetic_model = KineticModels(model_config['rates'])
        K, n_species = kinetic_model.get_kinetic_matrix(model_config['number'])
    else:
        # å¤„ç†è‡ªå®šä¹‰æ¨¡å‹
        pass
    
    # æ‰§è¡Œåˆ†æ
    solver = GTASolver(wavelengths, delays, spectra)
    solver.set_kinetic_matrix(K)
    result = solver.fit_parameters(model_config['rates'])
    
    return result
```

### 3. ä¸å¯è§†åŒ–ç³»ç»Ÿé›†æˆ

```python
# åœ¨visualize_results.pyä¸­æ·»åŠ GTAå¯è§†åŒ–
def add_gta_visualization_support():
    """æ·»åŠ GTAç»“æœå¯è§†åŒ–æ”¯æŒ"""
    
    def visualize_gta_results(result_dir, language='zh'):
        from gta_analysis import GTAVisualization
        
        # åŠ è½½GTAç»“æœ
        results = load_gta_results(result_dir)
        
        # åˆ›å»ºå¯è§†åŒ–
        viz = GTAVisualization(language=language)
        
        # ç”ŸæˆæŠ¥å‘Š
        viz.create_comprehensive_report(
            gta_solver=results['solver'],
            fit_result=results['fit_result'],
            output_dir=f"{result_dir}/gta_plots"
        )
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€åˆ†ææµç¨‹
```python
from gta_analysis import GTASolver, KineticModels, GTAVisualization

# 1. æ•°æ®å‡†å¤‡
wavelengths = np.linspace(400, 700, 100)
delays = np.logspace(-1, 3, 50)
experimental_data = load_tas_data()

# 2. æ¨¡å‹åˆ›å»º
kinetic_model = KineticModels([1.0, 0.5])
K, n_species = kinetic_model.get_kinetic_matrix(2)

# 3. åˆ†ææ‰§è¡Œ
solver = GTASolver(wavelengths, delays, experimental_data)
solver.set_kinetic_matrix(K)
result = solver.fit_parameters([1.0, 0.5])

# 4. ç»“æœå¯è§†åŒ–
viz = GTAVisualization(language='zh')
viz.create_comprehensive_report(solver, result, 'output_dir')
```

### æ‰¹é‡æ¨¡å‹æ¯”è¾ƒ
```python
from gta_analysis import create_gta_config_from_template

models = ['sequential_stable', 'parallel_a_to_bc', 'sequential_b_to_d_branch']
results = {}

for model_type in models:
    config = create_gta_config_from_template(
        model_type=model_type,
        rate_constants=get_initial_guess(model_type)
    )
    
    result = run_gta_with_config(config, experimental_data)
    results[model_type] = result

best_model = min(results.items(), key=lambda x: x[1]['reduced_chi_squared'])
```

## è´¨é‡ä¿è¯

### 1. æµ‹è¯•è¦†ç›–
- âœ… **å•å…ƒæµ‹è¯•**: æ¯ä¸ªæ¨¡å—çš„æ ¸å¿ƒåŠŸèƒ½
- âœ… **é›†æˆæµ‹è¯•**: æ¨¡å—é—´æ¥å£æµ‹è¯•
- âœ… **ç«¯åˆ°ç«¯æµ‹è¯•**: å®Œæ•´åˆ†ææµç¨‹
- âœ… **é”™è¯¯å¤„ç†**: å¼‚å¸¸æƒ…å†µå¤„ç†

### 2. æ€§èƒ½ä¼˜åŒ–
- âœ… **ç®—æ³•æ•ˆç‡**: ä½¿ç”¨ç»è¿‡ä¼˜åŒ–çš„ç§‘å­¦è®¡ç®—åº“
- âœ… **å†…å­˜ç®¡ç†**: å¤§æ•°æ®é›†çš„é«˜æ•ˆå¤„ç†
- âœ… **å¹¶è¡Œæ”¯æŒ**: æ‰¹é‡åˆ†æçš„å¹¶è¡ŒåŒ–

### 3. æ–‡æ¡£å®Œæ•´æ€§
- âœ… **APIæ–‡æ¡£**: è¯¦ç»†çš„å‡½æ•°å’Œç±»è¯´æ˜
- âœ… **ç”¨æˆ·æŒ‡å—**: å®Œæ•´çš„ä½¿ç”¨æ•™ç¨‹
- âœ… **ç¤ºä¾‹ä»£ç **: ä¸°å¯Œçš„ä½¿ç”¨ç¤ºä¾‹
- âœ… **æ•…éšœæ’é™¤**: å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ä¸‹ä¸€æ­¥è®¡åˆ’

### 1. çŸ­æœŸç›®æ ‡ (1-2å‘¨)
- ğŸ”„ **çœŸå®æ•°æ®æµ‹è¯•**: ä½¿ç”¨é¡¹ç›®å®é™…TASæ•°æ®éªŒè¯
- ğŸ”„ **æ€§èƒ½è°ƒä¼˜**: é’ˆå¯¹å¤§æ•°æ®é›†ä¼˜åŒ–æ€§èƒ½
- ğŸ”„ **é”™è¯¯å¤„ç†**: å®Œå–„è¾¹ç¼˜æƒ…å†µå¤„ç†

### 2. ä¸­æœŸç›®æ ‡ (1-2ä¸ªæœˆ)
- ğŸ“‹ **GUIé›†æˆ**: æ·»åŠ å›¾å½¢ç•Œé¢æ”¯æŒ
- ğŸ“‹ **é«˜çº§åŠŸèƒ½**: æ¸©åº¦ä¾èµ–ã€å¤šæ³¢é•¿æ¿€å‘ç­‰
- ğŸ“‹ **æ–‡æ¡£å®Œå–„**: æ·»åŠ æ›´å¤šå®é™…åº”ç”¨æ¡ˆä¾‹

### 3. é•¿æœŸç›®æ ‡ (3-6ä¸ªæœˆ)
- ğŸ“‹ **ç®—æ³•æ‰©å±•**: æ·»åŠ æ–°çš„åŠ¨åŠ›å­¦æ¨¡å‹
- ğŸ“‹ **æœºå™¨å­¦ä¹ **: é›†æˆæ™ºèƒ½å‚æ•°ä¼˜åŒ–
- ğŸ“‹ **äº‘è®¡ç®—**: æ”¯æŒåˆ†å¸ƒå¼å¤§è§„æ¨¡åˆ†æ

## ç»“è®º

æœ¬GTAæ¨¡å—çš„å®ç°æˆåŠŸè¾¾åˆ°äº†ä»¥ä¸‹ç›®æ ‡ï¼š

1. **åŠŸèƒ½å®Œæ•´æ€§**: å®Œå…¨å®ç°äº†EfsTAçš„æ ¸å¿ƒGTAåŠŸèƒ½
2. **ç³»ç»Ÿé›†æˆæ€§**: ä¸ç°æœ‰TAS MCR-ALSç³»ç»Ÿæ·±åº¦é›†æˆ
3. **æ˜“ç”¨æ€§**: æä¾›ç›´è§‚çš„APIå’Œä¸°å¯Œçš„æ–‡æ¡£
4. **å¯æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
5. **æ€§èƒ½å¯é æ€§**: ç»è¿‡æµ‹è¯•éªŒè¯çš„ç¨³å®šå®ç°

è¯¥æ¨¡å—ä¸ºTASæ•°æ®åˆ†ææä¾›äº†å¼ºå¤§çš„åŠ¨åŠ›å­¦å»ºæ¨¡èƒ½åŠ›ï¼Œæ˜¾è‘—æå‡äº†é¡¹ç›®çš„åˆ†ææ·±åº¦å’Œå‡†ç¡®æ€§ã€‚é€šè¿‡ä¸ç°æœ‰ç³»ç»Ÿçš„æ·±åº¦é›†æˆï¼Œç”¨æˆ·å¯ä»¥seamlesslyåœ°åœ¨MCR-ALSå’ŒGTAä¹‹é—´åˆ‡æ¢ï¼Œè·å¾—æœ€ä½³çš„åˆ†ææ•ˆæœã€‚

**é¡¹ç›®çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œå¯æŠ•å…¥ä½¿ç”¨
**ä»£ç è´¨é‡**: âœ… é«˜è´¨é‡ï¼Œéµå¾ªæœ€ä½³å®è·µ
**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæ•´ï¼Œç”¨æˆ·å‹å¥½
**æµ‹è¯•çŠ¶æ€**: âœ… åŸºç¡€æµ‹è¯•é€šè¿‡ï¼Œå¾…çœŸå®æ•°æ®éªŒè¯